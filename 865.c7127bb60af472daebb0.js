"use strict";(self.webpackChunkLab_aguas_cunoc=self.webpackChunkLab_aguas_cunoc||[]).push([[865],{4865:(k,c,i)=>{i.r(c),i.d(c,{LoteModule:()=>P});var m=i(8583),g=i(9516),n=i(665),e=i(3018),_=i(996),f=i(1841);let q=(()=>{class r extends _.O{constructor(t){super(t),this.http=t,this.url={lote:"lote"}}getLotes(t){return this.get(this.url.lote,t)}getLote(t,o){return this.get(this.url.lote+"/"+t+"/show",o)}storeLote(t){return this.post(this.url.lote,t)}deleteLote(t,o){return this.delete(this.url.lote+"/"+t,o)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(f.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var T=i(9344),h=i(4192),A=i(932),d=i(8295),Z=i(9983),p=i(7539);function b(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.qZA(),e.TgZ(20,"td"),e._uU(21),e.qZA(),e.TgZ(22,"td"),e._uU(23),e.qZA(),e.TgZ(24,"td"),e.TgZ(25,"div",50),e.TgZ(26,"button",51),e._UZ(27,"i",52),e.qZA(),e.TgZ(28,"button",53),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().modalEditar(s)}),e._UZ(29,"i",54),e.qZA(),e.TgZ(30,"button",55),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().modalEditar(s)}),e._UZ(31,"i",56),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=a.$implicit;e.xp6(2),e.hij("LOT-",t.codigo+"-"+t.numero+"-"+t.year," "),e.xp6(2),e.Oqu(e.Dn7(5,11,t.fecha,"dd-MM-yyyy","UTC +6")),e.xp6(3),e.Oqu(t.remitente),e.xp6(2),e.Oqu(t.cantidad_muestras),e.xp6(2),e.Oqu(t.no_cadena),e.xp6(2),e.Oqu(t.refrigerado?"SI":"NO"),e.xp6(2),e.Oqu(t.tomado_por),e.xp6(2),e.Oqu(t.persona_entrega),e.xp6(2),e.Oqu(t.contacto),e.xp6(2),e.Oqu(t.observaciones),e.xp6(2),e.Oqu(t.proyecto)}}function v(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar remitente"),e.qZA())}function U(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar un valor"),e.qZA())}function F(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar una cantidad"),e.qZA())}function y(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar un valor"),e.qZA())}function C(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar un valor"),e.qZA())}function x(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar valor"),e.qZA())}function L(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar valor"),e.qZA())}function I(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar valor"),e.qZA())}function N(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar valor"),e.qZA())}function O(r,a){if(1&r&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&r){const t=a.$implicit,o=e.oxw();e.Q6J("value",t.id)("selected",t.id==o.loteForm.controls.cliente_id.value),e.xp6(1),e.hij("",t.nombre," ")}}function S(r,a){if(1&r&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&r){const t=a.$implicit,o=e.oxw();e.Q6J("value",t.id)("selected",t.id==o.loteForm.controls.proyecto_id.value),e.xp6(1),e.hij("",t.nombre," ")}}function J(r,a){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Por favor ingresar c\xf3digo del lote"),e.qZA())}const V=[{path:"index",component:(()=>{class r{constructor(t,o,l,s,u){this.loteService=t,this.fb=o,this.toastr=l,this.proyectoService=s,this.clienteService=u,this.btn_disabled=!1,this.accion="Nuevo lote",this.lotes=[],this.clientes=[],this.proyectos_completos=[],this.proyectos=[],this.codigo_manual=!1,this.loteForm=this.fb.group({codigo:["",n.kI.required],numero:[""],year:[""],remitente:["",n.kI.required],fecha:["",n.kI.required],boleta:[""],cantidad_muestras:[1,n.kI.required],cadena:[0,n.kI.required],no_cadena:[""],refrigerado:[""],tomado_por:["",n.kI.required],persona_entrega:["",n.kI.required],contacto:["",n.kI.required],observaciones:["",n.kI.required],enabled:[1],cliente_id:[0],proyecto_id:[""],id:["0"]})}ngOnInit(){this.loadLotes()}loadLotes(){this.loteService.getLotes().subscribe(t=>{this.lotes=t.body}),this.proyectoService.getProyectos().subscribe(t=>{this.proyectos_completos=t.body}),this.clienteService.getClientes().subscribe(t=>{this.clientes=t.body})}modalNuevo(){this.accion="Nuevo lote",this.loteForm.reset(),this.loteForm.controls.enabled.setValue(1),this.loteForm.controls.cantidad_muestras.setValue(1),this.loteForm.controls.cadena.setValue(0)}modalEditar(t){this.accion="Editar: LOT-"+this.loteForm.controls.codigo.value+"-"+this.loteForm.controls.numero.value+"-"+this.loteForm.controsl.year.value,this.loteForm.controls.id.setValue(t.id),this.loteForm.controls.proyecto_id.setValue(t.proyecto_id),this.loteForm.controls.codigo.setValue(t.codigo),this.loteForm.controls.numero.setValue(t.numero),this.loteForm.controls.year.setValue(t.year),this.loteForm.controls.remitente.setValue(t.remitente);let o=String(t.fecha).substring(0,10);this.loteForm.controls.fecha.setValue(o),this.loteForm.controls.boleta.setValue(t.boleta),this.loteForm.controls.cantidad_muestras.setValue(t.cantidad_muestras),this.loteForm.controls.cadena.setValue(t.cadena),this.loteForm.controls.no_cadena.setValue(t.no_cadena),this.loteForm.controls.refrigerado.setValue(t.refrigerado),this.loteForm.controls.tomado_por.setValue(t.tomado_por),this.loteForm.controls.persona_entrega.setValue(t.persona_entrega),this.loteForm.controls.contacto.setValue(t.contacto),this.loteForm.controls.observaciones.setValue(t.observaciones),this.loteForm.controls.enabled.setValue(t.enabled)}onSubmit(){this.btn_disabled=!0,this.loteService.storeLote(this.loteForm.value).subscribe(t=>{200==t.status&&(this.toastr.success(t.body.message||"Operaci\xf3n completada","SUCCESS"),this.loadLotes(),setTimeout(()=>{this.btn_disabled=!1},2e3))},t=>{setTimeout(()=>{this.btn_disabled=!1},2e3),this.toastr.error(t.error.message,"ERROR")})}eliminarLote(t){this.loteService.deleteLote(t).subscribe(o=>{200==o.status&&(this.toastr.success(o.body.message||"Operaci\xf3n completada","SUCCESS"),this.loadLotes()),o.success&&(this.toastr.success(o.message||"Operaci\xf3n completada","SUCCESS"),this.loadLotes())},o=>{this.toastr.error(o.error.message,"ERROR")})}filtrarProyectos(){this.proyectos=this.proyectos_completos.filter(0!=this.loteForm.controls.cliente_id.value?o=>o.cliente_id==this.loteForm.controls.cliente_id.value:o=>o.cliente_id==this.clientes[0].id);let t=this.clientes.filter(o=>o.id==this.loteForm.controls.cliente_id.value);this.loteForm.controls.codigo.setValue(t[0].codigo?t[0].codigo:"")}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(q),e.Y36(n.qu),e.Y36(T._W),e.Y36(h.X),e.Y36(A.$))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-index-lote"]],decls:175,vars:24,consts:[[1,"card"],[1,"card-header","row"],[1,"col-md-11"],[1,""],[1,"col-md-1"],["data-toggle","modal","data-target","#modal-editar",1,"btn","btn-sm","btn-block","btn-primary",3,"click"],[1,"card-body"],[1,"table","table-sm","table-stripped","table-bordered"],[4,"ngFor","ngForOf"],["id","modal-editar",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"formGroup","ngSubmit"],[1,"modal-body"],["type","hidden","formControlName","id"],[1,"row"],[1,"col-12","mb-1"],[2,"color","red"],[1,"col-md-5","mb-1"],["appearance","outline",1,"field"],["matInput","","type","text","placeholder","","formControlName","remitente","required","",1,"example-right-align"],[4,"ngIf"],[1,"col-md-3","mb-1"],["matInput","","type","date","placeholder","","formControlName","fecha","required","",1,"example-right-align"],["matInput","","type","number","placeholder","","formControlName","cantidad_muestras","required","","min","1",1,"example-right-align"],["matInput","","type","text","placeholder","","formControlName","boleta",1,"example-right-align"],["matInput","","type","text","placeholder","","formControlName","no_cadena",1,"example-right-align"],[1,"col-md-2","mb-1"],["matInput","","type","number","placeholder","","formControlName","year","required","","min","2000",1,"example-right-align"],[1,"col-md-6","mb-1"],["matInput","","type","text","placeholder","","formControlName","tomado_por","required","",1,"example-right-align"],["matInput","","type","text","placeholder","","formControlName","persona_entrega","required","",1,"example-right-align"],["matInput","","type","text","placeholder","","formControlName","contacto","required","",1,"example-right-align"],["matInput","","type","text","placeholder","","formControlName","observaciones","required","",1,"example-right-align"],["matNativeControl","","formControlName","cliente_id","required","",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["matNativeControl","","formControlName","proyecto_id","required",""],["matInput","","type","text","placeholder","","formControlName","codigo","required","",1,"example-right-align"],[1,"col-md-4","mt-1","px-3"],["formControlName","refrigerado",1,"example-margin"],[1,"modal-footer","justify-content-between"],["type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",1,"btn","btn-primary",3,"disabled"],["id","modal-eliminar",1,"modal","fade"],["role","alert",1,"alert","alert-danger"],["type","submit","data-dismiss","modal",1,"btn","btn-danger",3,"click"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-info"],[1,"fas","fa-eye"],["type","button","data-toggle","modal","data-target","#modal-editar",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-edit"],["type","button","data-toggle","modal","data-target","#modal-eliminar",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[3,"value","selected"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h5",3),e._uU(4,"Listado de lotes"),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return o.modalNuevo()}),e._uU(7," Nuevo "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"table",7),e.TgZ(10,"thead"),e.TgZ(11,"tr"),e.TgZ(12,"th"),e._uU(13,"Identificador"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Fecha"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Remitente"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Muestras"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Cadena"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"Refrigerado"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Tomado por"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"Persona que entrega"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Contacto"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Observaciones"),e.qZA(),e.TgZ(32,"th"),e._uU(33,"Proyecto"),e.qZA(),e.TgZ(34,"th"),e._uU(35,"Acciones"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(36,"tbody"),e.YNc(37,b,32,15,"tr",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",9),e.TgZ(39,"div",10),e.TgZ(40,"div",11),e.TgZ(41,"div",12),e.TgZ(42,"h4",13),e._uU(43),e.qZA(),e.TgZ(44,"button",14),e.TgZ(45,"span",15),e._uU(46,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(47,"form",16),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(48,"div",17),e._UZ(49,"input",18),e.TgZ(50,"div",19),e.TgZ(51,"div",20),e.TgZ(52,"small",21),e._uU(53,"* Campos obligatorios"),e.qZA(),e.qZA(),e._UZ(54,"hr"),e.TgZ(55,"div",22),e.TgZ(56,"mat-form-field",23),e.TgZ(57,"mat-label"),e._uU(58,"Remitente"),e.qZA(),e._UZ(59,"input",24),e.YNc(60,v,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(61,"div",26),e.TgZ(62,"mat-form-field",23),e.TgZ(63,"mat-label"),e._uU(64,"Fecha"),e.qZA(),e._UZ(65,"input",27),e.YNc(66,U,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(67,"div",26),e.TgZ(68,"mat-form-field",23),e.TgZ(69,"mat-label"),e._uU(70,"Cant. Muestras"),e.qZA(),e._UZ(71,"input",28),e.YNc(72,F,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(73,"div",22),e.TgZ(74,"mat-form-field",23),e.TgZ(75,"mat-label"),e._uU(76,"Boleta"),e.qZA(),e._UZ(77,"input",29),e.qZA(),e.qZA(),e.TgZ(78,"div",22),e.TgZ(79,"mat-form-field",23),e.TgZ(80,"mat-label"),e._uU(81,"Cadena de custodia"),e.qZA(),e._UZ(82,"input",30),e.YNc(83,y,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(84,"div",31),e.TgZ(85,"mat-form-field",23),e.TgZ(86,"mat-label"),e._uU(87,"A\xf1o"),e.qZA(),e._UZ(88,"input",32),e.YNc(89,C,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(90,"div",33),e.TgZ(91,"mat-form-field",23),e.TgZ(92,"mat-label"),e._uU(93,"Tomado por"),e.qZA(),e._UZ(94,"input",34),e.YNc(95,x,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(96,"div",33),e.TgZ(97,"mat-form-field",23),e.TgZ(98,"mat-label"),e._uU(99,"Persona que entrega"),e.qZA(),e._UZ(100,"input",35),e.YNc(101,L,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(102,"div",33),e.TgZ(103,"mat-form-field",23),e.TgZ(104,"mat-label"),e._uU(105,"Cont\xe1cto"),e.qZA(),e._UZ(106,"input",36),e.YNc(107,I,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(108,"div",33),e.TgZ(109,"mat-form-field",23),e.TgZ(110,"mat-label"),e._uU(111,"Observaciones"),e.qZA(),e._UZ(112,"input",37),e.YNc(113,N,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(114,"div",22),e.TgZ(115,"mat-form-field",23),e.TgZ(116,"mat-label"),e._uU(117,"Cliente"),e.qZA(),e.TgZ(118,"select",38),e.NdJ("change",function(){return o.filtrarProyectos()}),e.YNc(119,O,2,3,"option",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(120,"div",22),e.TgZ(121,"mat-form-field",23),e.TgZ(122,"mat-label"),e._uU(123,"Proyecto"),e.qZA(),e.TgZ(124,"select",40),e.YNc(125,S,2,3,"option",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(126,"div",31),e.TgZ(127,"mat-form-field",23),e.TgZ(128,"mat-label"),e._uU(129,"C\xf3digo"),e.qZA(),e._UZ(130,"input",41),e.YNc(131,J,2,0,"mat-error",25),e.qZA(),e.qZA(),e.TgZ(132,"div",42),e.TgZ(133,"mat-checkbox",43),e._uU(134,"Refrigerado "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(135,"div",44),e.TgZ(136,"button",45),e._uU(137,"Cerrar"),e.qZA(),e.TgZ(138,"button",46),e._uU(139,"Guardar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(140,"div",47),e.TgZ(141,"div",10),e.TgZ(142,"div",11),e.TgZ(143,"div",12),e.TgZ(144,"h4",13),e._uU(145,"Eliminar registro"),e.qZA(),e.TgZ(146,"button",14),e.TgZ(147,"span",15),e._uU(148,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(149,"div",17),e.TgZ(150,"div",48),e.TgZ(151,"h3"),e._uU(152,"Est\xe1 seguro de eliminar este lote?"),e.qZA(),e.TgZ(153,"p"),e._uU(154,"C\xf3digo: "),e.TgZ(155,"b"),e._uU(156),e.qZA(),e.qZA(),e.TgZ(157,"p"),e._uU(158,"Fecha: "),e.TgZ(159,"b"),e._uU(160),e.ALo(161,"date"),e.qZA(),e.qZA(),e.TgZ(162,"p"),e._uU(163,"Muestras: "),e.TgZ(164,"b"),e._uU(165),e.qZA(),e.qZA(),e._UZ(166,"hr"),e._UZ(167,"br"),e.TgZ(168,"b"),e._uU(169,"Esta acci\xf3n no se puede deshacer!!"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(170,"div",44),e.TgZ(171,"button",45),e._uU(172,"Cerrar"),e.qZA(),e.TgZ(173,"button",49),e.NdJ("click",function(){return o.eliminarLote(o.loteForm.controls.id.value)}),e._uU(174,"Eliminar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(37),e.Q6J("ngForOf",o.lotes),e.xp6(6),e.Oqu(o.accion),e.xp6(4),e.Udp("font-size",15,"px"),e.Q6J("formGroup",o.loteForm),e.xp6(13),e.Q6J("ngIf",null==o.loteForm.get("remitente").errors?null:o.loteForm.get("remitente").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("fecha").errors?null:o.loteForm.get("fecha").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("cantidad_muestras").errors?null:o.loteForm.get("cantidad_muestras").errors.required),e.xp6(11),e.Q6J("ngIf",null==o.loteForm.get("no_cadena").errors?null:o.loteForm.get("no_cadena").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("year").errors?null:o.loteForm.get("year").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("tomado_por").errors?null:o.loteForm.get("tomado_por").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("persona_entrega").errors?null:o.loteForm.get("persona_entrega").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("contacto").errors?null:o.loteForm.get("contacto").errors.required),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("observaciones").errors?null:o.loteForm.get("observaciones").errors.required),e.xp6(6),e.Q6J("ngForOf",o.clientes),e.xp6(6),e.Q6J("ngForOf",o.proyectos),e.xp6(6),e.Q6J("ngIf",null==o.loteForm.get("codigo").errors?null:o.loteForm.get("codigo").errors.required),e.xp6(7),e.Q6J("disabled",!o.loteForm.valid||o.btn_disabled),e.xp6(18),e.hij("LOT-",o.loteForm.controls.codigo.value+"-"+o.loteForm.controls.numero.value+o.loteForm.controls.year.value,""),e.xp6(4),e.Oqu(e.xi3(161,21,o.loteForm.controls.fecha.value,"dd-MM-yyyy")),e.xp6(5),e.Oqu(o.loteForm.controls.cantidad_muestras.value))},directives:[m.sg,n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,d.KE,d.hX,Z.Nt,n.Q7,m.O5,n.wV,n.qQ,n.EJ,p.oG,d.TO,n.YN,n.Kr],pipes:[m.uU],styles:[""]}),r})()},{path:"lote/:id",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-ver-lote"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"ver-lote works!"),e.qZA())},styles:[""]}),r})()},{path:"**",redirectTo:"index"}];let Y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[g.Bz.forChild(V)],g.Bz]}),r})();var Q=i(7441),E=i(2613);let P=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[m.ez,Y,n.u5,n.UX,Z.c,d.lN,Q.LD,E.Fk,p.p9]]}),r})()}}]);