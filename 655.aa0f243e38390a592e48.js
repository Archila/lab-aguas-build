"use strict";(self.webpackChunkLab_aguas_cunoc=self.webpackChunkLab_aguas_cunoc||[]).push([[655],{3655:(S,d,s)=>{s.r(d),s.d(d,{UsuarioModule:()=>N});var m=s(8583),Z=s(9516),a=s(665),o=s(3018),p=s(1537),b=s(9344),f=s(5763),l=s(8295),g=s(9983);function T(e,i){if(1&e){const r=o.EpF();o.TgZ(0,"tr"),o.TgZ(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA(),o.TgZ(7,"td"),o.TgZ(8,"div",40),o.TgZ(9,"button",41),o._UZ(10,"i",42),o.qZA(),o.TgZ(11,"button",43),o.NdJ("click",function(){const u=o.CHM(r).$implicit;return o.oxw().modalEditar(u)}),o._UZ(12,"i",44),o.qZA(),o.TgZ(13,"button",45),o.NdJ("click",function(){const u=o.CHM(r).$implicit;return o.oxw().modalEditar(u)}),o._UZ(14,"i",46),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&e){const r=i.$implicit;o.xp6(2),o.Oqu(r.name),o.xp6(2),o.Oqu(r.nombre),o.xp6(2),o.Oqu(r.rol)}}function q(e,i){1&e&&(o.TgZ(0,"mat-error"),o._uU(1,"Por favor ingresar nombre de usuario"),o.qZA())}function h(e,i){1&e&&(o.TgZ(0,"mat-error"),o._uU(1,"Por favor ingrese un nombre"),o.qZA())}function A(e,i){1&e&&(o.TgZ(0,"mat-error"),o._uU(1,"Por favor ingrese clave"),o.qZA())}function U(e,i){1&e&&(o.TgZ(0,"mat-error"),o._uU(1,"Por favor ingrese clave"),o.qZA())}function _(e,i){if(1&e&&(o.TgZ(0,"option",47),o._uU(1),o.qZA()),2&e){const r=i.$implicit;o.Q6J("value",r.id),o.xp6(1),o.hij("",r.nombre," ")}}function v(e,i){if(1&e&&(o.TgZ(0,"p",48),o._uU(1),o.qZA()),2&e){const r=o.oxw();o.xp6(1),o.Oqu(r.error_msg)}}let c=(()=>{class e{constructor(r,t,n,u){this.configuracionService=r,this.fb=t,this.toastr=n,this.usuarioService=u,this.btn_disabled=!1,this.usuarios=[],this.accion="Nuevo usuario",this.roles_permitidos=[1],this.error=!1,this.error_msg="",this.roles=[{id:1,nombre:"ENCARGADO"},{id:2,nombre:"DOCENTE"},{id:3,nombre:"ESTUDIANTE"}],this.usuarioForm=this.fb.group({name:["",a.kI.required],nombre:["",a.kI.required],email:["-"],password:["",a.kI.required],password2:["",a.kI.required],rol:[2,a.kI.required],id:["0"]})}ngOnInit(){this.usuarioService.validarPermisos(this.roles_permitidos),this.loadClientes()}loadClientes(){this.usuarioService.getUsuarios({}).subscribe(r=>{this.usuarios=r.body,console.log(this.usuarios)})}modalNuevo(){this.accion="Nuevo usuario",this.usuarioForm.reset()}modalEditar(r){this.accion="Editar usuario",this.usuarioForm.controls.name.setValue(r.name),this.usuarioForm.controls.nombre.setValue(r.nombre),this.usuarioForm.controls.email.setValue(r.email),this.usuarioForm.controls.password.setValue(r.password),this.usuarioForm.controls.rol.setValue(r.rol),this.usuarioForm.controls.id.setValue(r.id)}onSubmit(){this.btn_disabled=!0,this.error=!1,this.usuarioForm.controls.password.value!=this.usuarioForm.controls.password2.value&&(this.error=!0,this.error_msg="Las claves no son iguales.",this.btn_disabled=!1),this.usuarioForm.controls.email.setValue(this.usuarioForm.controls.name.value+"@algo.com"),this.error||this.usuarioService.storeUsuario(this.usuarioForm.value).subscribe(r=>{200==r.status&&(this.toastr.success(r.body.message||"Operaci\xf3n completada","SUCCESS"),this.loadClientes(),setTimeout(()=>{this.btn_disabled=!1},2e3))},r=>{setTimeout(()=>{this.btn_disabled=!1},2e3),this.toastr.error(r.error.message,"ERROR")})}eliminarCliente(r){this.usuarioService.deleteUsuario(r,{}).subscribe(t=>{200==t.status&&(this.toastr.success(t.body.message||"Operaci\xf3n completada","SUCCESS"),this.loadClientes()),t.success&&(this.toastr.success(t.message||"Operaci\xf3n completada","SUCCESS"),this.loadClientes())},t=>{this.toastr.error(t.error.message,"ERROR")})}}return e.\u0275fac=function(r){return new(r||e)(o.Y36(p.P),o.Y36(a.qu),o.Y36(b._W),o.Y36(f.i))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-index-usuario"]],decls:105,vars:14,consts:[[1,"card"],[1,"card-header","row"],[1,"col-md-11"],[1,""],[1,"col-md-1"],["data-toggle","modal","data-target","#modal-editar",1,"btn","btn-sm","btn-block","btn-primary",3,"click"],[1,"card-body"],[1,"table","table-stripped","table-bordered"],[4,"ngFor","ngForOf"],["id","modal-editar",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"formGroup","ngSubmit"],[1,"modal-body"],["type","hidden","formControlName","id"],[1,"row"],[1,"col-12","mb-1"],[2,"color","red"],[1,"col-md-4","mb-1"],["appearance","outline",1,"field"],["matInput","","type","text","placeholder","","formControlName","name","required","",1,"example-right-align"],[4,"ngIf"],[1,"col-md-8","mb-1"],["matInput","","type","text","placeholder","","formControlName","nombre","required","",1,"example-right-align"],[1,"col-md-6","mb-1"],["matInput","","type","password","placeholder","","formControlName","password","required","",1,"example-right-align"],["matInput","","type","password","placeholder","","formControlName","password2","required","",1,"example-right-align"],["matNativeControl","","formControlName","rol"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"modal-footer","justify-content-between"],["type","button","data-dismiss","modal",1,"btn","btn-default"],["type","submit",1,"btn","btn-primary",3,"disabled"],["id","modal-eliminar",1,"modal","fade"],["role","alert",1,"alert","alert-danger"],["type","submit","data-dismiss","modal",1,"btn","btn-danger",3,"click"],[1,"btn-group"],["type","button",1,"btn","btn-sm","btn-info"],[1,"fas","fa-eye"],["type","button","data-toggle","modal","data-target","#modal-editar",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-edit"],["type","button","data-toggle","modal","data-target","#modal-eliminar",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[3,"value"],[1,"text-danger"]],template:function(r,t){1&r&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"h5",3),o._uU(4,"Listado de usuarios"),o.qZA(),o.qZA(),o.TgZ(5,"div",4),o.TgZ(6,"button",5),o.NdJ("click",function(){return t.modalNuevo()}),o._uU(7," Nuevo "),o.qZA(),o.qZA(),o.qZA(),o.TgZ(8,"div",6),o.TgZ(9,"table",7),o.TgZ(10,"thead"),o.TgZ(11,"tr"),o.TgZ(12,"th"),o._uU(13,"Username"),o.qZA(),o.TgZ(14,"th"),o._uU(15,"Nombre"),o.qZA(),o.TgZ(16,"th"),o._uU(17,"Rol"),o.qZA(),o.TgZ(18,"th"),o._uU(19,"Acciones"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(20,"tbody"),o.YNc(21,T,15,3,"tr",8),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(22,"div",9),o.TgZ(23,"div",10),o.TgZ(24,"div",11),o.TgZ(25,"div",12),o.TgZ(26,"h4",13),o._uU(27),o.qZA(),o.TgZ(28,"button",14),o.TgZ(29,"span",15),o._uU(30,"\xd7"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(31,"form",16),o.NdJ("ngSubmit",function(){return t.onSubmit()}),o.TgZ(32,"div",17),o._UZ(33,"input",18),o.TgZ(34,"div",19),o.TgZ(35,"div",20),o.TgZ(36,"small",21),o._uU(37,"* Campos obligatorios"),o.qZA(),o.qZA(),o._UZ(38,"hr"),o.TgZ(39,"div",22),o.TgZ(40,"mat-form-field",23),o.TgZ(41,"mat-label"),o._uU(42,"Username"),o.qZA(),o._UZ(43,"input",24),o.YNc(44,q,2,0,"mat-error",25),o.qZA(),o.qZA(),o.TgZ(45,"div",26),o.TgZ(46,"mat-form-field",23),o.TgZ(47,"mat-label"),o._uU(48,"Nombre"),o.qZA(),o._UZ(49,"input",27),o.YNc(50,h,2,0,"mat-error",25),o.qZA(),o.qZA(),o.TgZ(51,"div",28),o.TgZ(52,"mat-form-field",23),o.TgZ(53,"mat-label"),o._uU(54,"Clave"),o.qZA(),o._UZ(55,"input",29),o.YNc(56,A,2,0,"mat-error",25),o.qZA(),o.qZA(),o.TgZ(57,"div",28),o.TgZ(58,"mat-form-field",23),o.TgZ(59,"mat-label"),o._uU(60,"Confirmar Clave"),o.qZA(),o._UZ(61,"input",30),o.YNc(62,U,2,0,"mat-error",25),o.qZA(),o.qZA(),o.TgZ(63,"div",28),o.TgZ(64,"mat-form-field",23),o.TgZ(65,"mat-label"),o._uU(66,"Rol"),o.qZA(),o.TgZ(67,"select",31),o.YNc(68,_,2,2,"option",32),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.YNc(69,v,2,1,"p",33),o.qZA(),o.TgZ(70,"div",34),o.TgZ(71,"button",35),o._uU(72,"Cerrar"),o.qZA(),o.TgZ(73,"button",36),o._uU(74,"Guardar"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(75,"div",37),o.TgZ(76,"div",10),o.TgZ(77,"div",11),o.TgZ(78,"div",12),o.TgZ(79,"h4",13),o._uU(80,"Eliminar registro"),o.qZA(),o.TgZ(81,"button",14),o.TgZ(82,"span",15),o._uU(83,"\xd7"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(84,"div",17),o.TgZ(85,"div",38),o.TgZ(86,"h3"),o._uU(87,"Est\xe1 seguro de eliminar el registro?"),o.qZA(),o.TgZ(88,"p"),o._uU(89,"Username: "),o.TgZ(90,"b"),o._uU(91),o.qZA(),o.qZA(),o.TgZ(92,"p"),o._uU(93,"Nombre: "),o.TgZ(94,"b"),o._uU(95),o.qZA(),o.qZA(),o._UZ(96,"hr"),o._UZ(97,"br"),o.TgZ(98,"b"),o._uU(99,"Esta acci\xf3n no se puede deshacer!!"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(100,"div",34),o.TgZ(101,"button",35),o._uU(102,"Cerrar"),o.qZA(),o.TgZ(103,"button",39),o.NdJ("click",function(){return t.eliminarCliente(t.usuarioForm.controls.id.value)}),o._uU(104,"Eliminar"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&r&&(o.xp6(21),o.Q6J("ngForOf",t.usuarios),o.xp6(6),o.Oqu(t.accion),o.xp6(4),o.Udp("font-size",15,"px"),o.Q6J("formGroup",t.usuarioForm),o.xp6(13),o.Q6J("ngIf",null==t.usuarioForm.get("name").errors?null:t.usuarioForm.get("name").errors.required),o.xp6(6),o.Q6J("ngIf",null==t.usuarioForm.get("nombre").errors?null:t.usuarioForm.get("nombre").errors.required),o.xp6(6),o.Q6J("ngIf",null==t.usuarioForm.get("password").errors?null:t.usuarioForm.get("password").errors.required),o.xp6(6),o.Q6J("ngIf",null==t.usuarioForm.get("password2").errors?null:t.usuarioForm.get("password2").errors.required),o.xp6(6),o.Q6J("ngForOf",t.roles),o.xp6(1),o.Q6J("ngIf",t.error),o.xp6(4),o.Q6J("disabled",!t.usuarioForm.valid||t.btn_disabled),o.xp6(18),o.Oqu(t.usuarioForm.controls.name.value),o.xp6(4),o.Oqu(t.usuarioForm.controls.nombre.value))},directives:[m.sg,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,l.KE,l.hX,g.Nt,a.Q7,m.O5,a.EJ,l.TO,a.YN,a.Kr],styles:[""]}),e})();const C=[{path:"usuario",component:c},{path:"rol",component:c},{path:"**",redirectTo:"usuario"}];let x=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[Z.Bz.forChild(C)],Z.Bz]}),e})();var F=s(7441),I=s(2613);let N=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[m.ez,x,a.u5,a.UX,g.c,l.lN,F.LD,I.Fk]]}),e})()}}]);